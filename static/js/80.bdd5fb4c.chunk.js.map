{"version":3,"file":"static/js/80.bdd5fb4c.chunk.js","mappings":"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","sources":["apis/article.js","hooks/useChannel.js","pages/Article/index.js"],"sourcesContent":["//封装文章发布\r\nimport { request } from \"../utils\"\r\n//获取频道列表\r\nexport function getChannelApi() {\r\n    return request({\r\n        url: \"/channels\",\r\n        method: \"GET\"\r\n    })\r\n}\r\n\r\n//提交文章表单 新增\r\nexport function createArticleApi(data){\r\n        return request({\r\n            url:\"/mp/articles?draft=false\",\r\n            method:\"POST\",\r\n            data\r\n        })\r\n}\r\n//提交文章表单 更新\r\nexport function updateArticleApi(data){\r\n    return request({\r\n        url:`/mp/articles/${data.id}?draft=false`,\r\n        method:\"PUT\",\r\n        data\r\n    })\r\n}\r\n\r\n//获取文章列表\r\nexport function getArticleApi(params){\r\n    return request({\r\n        url:\"/mp/articles\",\r\n        method:\"GET\",\r\n        params\r\n    })\r\n}\r\n\r\n//删除文章\r\nexport function deleteArticleApi(id){\r\n    return request({\r\n        url:`/mp/articles/${id}`,\r\n        method:\"DELETE\",\r\n    })\r\n}\r\n\r\n//根据id获取数据\r\nexport function getArticleByIdApi(id){\r\n    return request({\r\n        url:`/mp/articles/${id}`,\r\n        method:\"GET\",\r\n    })\r\n}","//多个地方要用频道列表，所以抽离为一个函数\r\nimport { useState,useEffect } from \"react\"\r\nimport { getChannelApi } from \"../apis/article\"\r\nfunction useChannel(){\r\n     //获取频道列表\r\n let [channelList, setChannelList] = useState([])\r\n useEffect(() => {\r\n     //封装函数，在函数体内调用接口\r\n     const getChannelList = async () => {\r\n         const res = await getChannelApi()\r\n         setChannelList(res.data.channels)\r\n     }\r\n     //调用函数\r\n     getChannelList()\r\n }, [])\r\n //把组件要用到的数据reture出去\r\n return {\r\n    channelList\r\n }\r\n}\r\nexport {useChannel}","import { Link, useNavigate } from 'react-router-dom'\r\nimport { Card, Breadcrumb, Form, Button, Radio, DatePicker, Select, Popconfirm } from 'antd'\r\nimport { useEffect, useState } from 'react'\r\nimport locale from 'antd/es/date-picker/locale/zh_CN'\r\nimport { Table, Tag, Space } from 'antd'\r\nimport { EditOutlined, DeleteOutlined } from '@ant-design/icons'\r\nimport img404 from '../../assets/error.png'\r\nimport { nanoid } from 'nanoid'\r\nimport { useChannel } from '../../hooks/useChannel'\r\nimport { deleteArticleApi, getArticleApi } from '../../apis/article'\r\nconst { Option } = Select\r\nconst { RangePicker } = DatePicker\r\n\r\n\r\n\r\nconst Article = () => {\r\nconst navigate=useNavigate()\r\n  const columns = [\r\n    {\r\n      title: '封面',\r\n      dataIndex: 'cover',\r\n      width: 120,\r\n      render: cover => {\r\n        return < img src={cover.images[0] || img404} width={80} height={60} alt=\"\" />\r\n      }\r\n    },\r\n    {\r\n      title: '标题',\r\n      dataIndex: 'title',\r\n      width: 220\r\n    },\r\n    {\r\n      title: '状态',\r\n      dataIndex: 'status',\r\n      // render: data => <Tag color=\"green\">审核通过</Tag>\r\n      //data===1待审核 data===2审核通过 data是后端返回的状态status 根据他做条件渲染\r\n      render: data => data === 1 ? <Tag color=\"warning\">待审核</Tag> : <Tag color=\"success\">审核通过</Tag>\r\n    },\r\n    {\r\n      title: '发布时间',\r\n      dataIndex: 'pubdate'\r\n    },\r\n    {\r\n      title: '阅读数',\r\n      dataIndex: 'read_count'\r\n    },\r\n    {\r\n      title: '评论数',\r\n      dataIndex: 'comment_count'\r\n    },\r\n    {\r\n      title: '点赞数',\r\n      dataIndex: 'like_count'\r\n    },\r\n    {\r\n      title: '操作',\r\n      render: data => {\r\n        return (\r\n          <Space size=\"middle\">\r\n            <Button type=\"primary\" shape=\"circle\" icon={<EditOutlined />} onClick={()=>{editInfo(data)}} />\r\n            <Popconfirm title=\"删除文章?\" okText=\"确认\" cancelText=\"取消\" onConfirm={() => { confirm(data) }}  >\r\n              <Button\r\n                type=\"primary\"\r\n                danger\r\n                shape=\"circle\"\r\n                icon={<DeleteOutlined />}\r\n              />\r\n            </Popconfirm>\r\n          </Space>\r\n        )\r\n      }\r\n    }\r\n  ]\r\n  // 准备表格body数据\r\n  const data = [\r\n    {\r\n      id: '8218',\r\n      comment_count: 0,\r\n      cover: {\r\n        images: [],\r\n      },\r\n      like_count: 0,\r\n      pubdate: '2019-03-11 09:00:00',\r\n      read_count: 2,\r\n      status: 2,\r\n      title: 'wkwebview离线化加载h5资源解决方案'\r\n    }\r\n  ]\r\n\r\n  //从自定义hook中获取频道数据\r\n  const { channelList } = useChannel()\r\n  //准备参数\r\n  const [reqData, setReqData] = useState({\r\n    status: '',\r\n    channel_id: \"\",\r\n    begin_pubdate: \"\",\r\n    end_pubdate: \"\",\r\n    page: 1,\r\n    per_page: 8\r\n  })\r\n\r\n  //获取文章列表\r\n  const [list, setList] = useState([])\r\n  const [count, setCount] = useState(0)\r\n  useEffect(() => {\r\n    async function getList() {\r\n      const res = await getArticleApi(reqData)\r\n      setList(res.data.results)\r\n      setCount(res.data.total_count)\r\n      // console.log(res.data);\r\n      // setCount(res.data.results.length)\r\n    }\r\n    getList()\r\n  }, [reqData])\r\n  //筛选功能\r\n  //获取表单数据\r\n  function onFinish(value) {\r\n    // console.log(value);\r\n    //表单数据放reqData中\r\n    setReqData({\r\n      ...reqData,\r\n      channel_id: value.channel_id,\r\n      status: value.status,\r\n      begin_pubdate: value.date[0].format(\"YYYY-MM-DD\"),\r\n      end_pubdate: value.date[1].format(\"YYYY-MM-DD\")\r\n    })\r\n    //重新渲染table\r\n    //105行 reqData依赖发送变化，重复执行副作用函数\r\n  }\r\n\r\n  //分页\r\n  function onPageChange(page) {\r\n    //重新渲染table\r\n    // console.log(page);\r\n    const {current}=page\r\n    //105行 reqData依赖发送变化，重复执行副作用函数\r\n    setReqData({\r\n      ...reqData,\r\n      page:current\r\n    })\r\n  }\r\n\r\n  //删除\r\n  const confirm = async (data) => {\r\n    // console.log(data);\r\n    //调用接口删除，根据id删除\r\n    await deleteArticleApi(data.id)\r\n    //改变依赖性，更新界面\r\n    setReqData({\r\n      ...reqData\r\n    })\r\n  }\r\n\r\n//修改\r\nconst editInfo= (data)=>{\r\n  //  console.log(data.id);\r\n  navigate(`/publish?id=${data.id}`)\r\n}\r\n  return (\r\n    <div>\r\n      <Card\r\n        title={\r\n          <Breadcrumb items={[\r\n            { title: <Link to={'/'}>首页</Link> },\r\n            { title: '文章列表' },\r\n          ]} />\r\n        }\r\n        style={{ marginBottom: 20 }}\r\n      >\r\n        <Form initialValues={{ status: '' }} onFinish={onFinish}>\r\n          <Form.Item label=\"状态\" name=\"status\">\r\n            <Radio.Group>\r\n              <Radio value={''}>全部</Radio>\r\n              <Radio value={0}>草稿</Radio>\r\n              <Radio value={2}>审核通过</Radio>\r\n            </Radio.Group>\r\n          </Form.Item>\r\n\r\n          <Form.Item label=\"频道\" name=\"channel_id\">\r\n            <Select\r\n              placeholder=\"请选择文章频道\"\r\n              style={{ width: 120 }}\r\n            >\r\n              {\r\n                // value收集用户的输入\r\n                channelList.map((item) => <Option key={nanoid()} value={item.id}>{item.name}</Option>)\r\n              }\r\n            </Select>\r\n          </Form.Item>\r\n\r\n          <Form.Item label=\"日期\" name=\"date\">\r\n            {/* 传入locale属性 控制中文显示*/}\r\n            <RangePicker locale={locale}></RangePicker>\r\n          </Form.Item>\r\n\r\n          <Form.Item>\r\n            <Button type=\"primary\" htmlType=\"submit\" style={{ marginLeft: 40 }}>\r\n              筛选\r\n            </Button>\r\n          </Form.Item>\r\n        </Form>\r\n      </Card>\r\n      <Card title={`根据筛选条件查询到了${count}条数据`}>\r\n        <Table columns={columns} dataSource={list} pagination={{\r\n          total: count,\r\n          pageSize: reqData.per_page\r\n        }} onChange={onPageChange} />\r\n      </Card>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Article"],"names":["getChannelApi","request","url","method","createArticleApi","data","updateArticleApi","concat","id","getArticleApi","params","deleteArticleApi","getArticleByIdApi","useChannel","_useState","useState","_useState2","_slicedToArray","channelList","setChannelList","useEffect","getChannelList","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","res","wrap","_context","prev","next","sent","channels","stop","apply","arguments","Option","Select","RangePicker","DatePicker","navigate","useNavigate","columns","title","dataIndex","width","render","cover","_jsx","src","images","img404","height","alt","Tag","color","children","_jsxs","Space","size","Button","type","shape","icon","EditOutlined","onClick","editInfo","Popconfirm","okText","cancelText","onConfirm","confirm","danger","DeleteOutlined","status","channel_id","begin_pubdate","end_pubdate","page","per_page","reqData","setReqData","_useState3","_useState4","list","setList","_useState5","_useState6","count","setCount","_getList","results","total_count","getList","_callee2","_context2","_objectSpread","_x","Card","Breadcrumb","items","Link","to","style","marginBottom","Form","initialValues","onFinish","value","date","format","Item","label","name","Radio","placeholder","map","item","nanoid","locale","htmlType","marginLeft","Table","dataSource","pagination","total","pageSize","onChange","current"],"sourceRoot":""}